{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-body">
                <h1 class="card-title text-center mb-4">üöÄ Advanced URL Shortener</h1>
                <p class="text-center text-muted">Create smart, secure, and trackable short links</p>
                
                <form method="POST" class="mb-4">
                    <div class="mb-3">
                        <label for="url" class="form-label">Enter your long URL:</label>
                        <input type="url" class="form-control form-control-lg" id="url" name="url" 
                               placeholder="https://example.com/very/long/url" required>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="custom_code" class="form-label">Custom alias (optional):</label>
                                <input type="text" class="form-control" id="custom_code" name="custom_code" 
                                       placeholder="my-custom-link" maxlength="20">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="description" class="form-label">Description (optional):</label>
                                <input type="text" class="form-control" id="description" name="description" 
                                       placeholder="What is this link for?" maxlength="255">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Advanced Options -->
                    <div class="card bg-light mb-3">
                        <div class="card-header">
                            <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#advancedOptions">
                                üîß Advanced Options
                            </button>
                        </div>
                        <div class="collapse" id="advancedOptions">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="expires_in" class="form-label">Expires in (days):</label>
                                            <input type="number" class="form-control" id="expires_in" 
                                                   name="expires_in" placeholder="30" min="1" max="365">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="click_limit" class="form-label">Click limit:</label>
                                            <input type="number" class="form-control" id="click_limit" 
                                                   name="click_limit" placeholder="100" min="1">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="password" class="form-label">Password protect:</label>
                                            <input type="password" class="form-control" id="password" 
                                                   name="password" placeholder="Optional password">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-lg w-100">Create Smart Link</button>
                </form>
                
                {% if short_url %}
                <div class="result-section">
                    <hr>
                    <h3>‚úÖ Your smart link is ready!</h3>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" value="{{ short_url }}" id="shortUrl" readonly>
                        <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard()">Copy</button>
                        <a href="{{ url_for('preview_url', short_code=short_url.split('/')[-1]) }}" 
                           class="btn btn-info" target="_blank">Preview</a>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Original URL:</strong><br>
                            <small class="text-muted">{{ original_url }}</small></p>
                            
                            {% if expires_at %}
                            <p><strong>Expires:</strong> <span class="text-warning">{{ expires_at.strftime('%B %d, %Y') }}</span></p>
                            {% endif %}
                            
                            {% if has_password %}
                            <p><strong>Protection:</strong> <span class="text-info">üîí Password protected</span></p>
                            {% endif %}
                            
                            {% if click_limit %}
                            <p><strong>Click Limit:</strong> <span class="text-warning">{{ click_limit }} clicks</span></p>
                            {% endif %}
                            
                            <a href="{{ url_for('stats', short_code=short_url.split('/')[-1]) }}" 
                               class="btn btn-info btn-sm">üìä View Analytics</a>
                        </div>
                        <div class="col-md-6 text-center">
                            <p><strong>QR Code:</strong></p>
                            <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code" class="qr-code">
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <h5>üìä Bulk Shortening</h5>
                        <p>Shorten multiple URLs at once</p>
                        <a href="{{ url_for('bulk_shorten') }}" class="btn btn-outline-primary">Try Bulk Tool</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <h5>üîß Admin Dashboard</h5>
                        <p>View all links and analytics</p>
                        <a href="{{ url_for('dashboard') }}" class="btn btn-outline-success">View Dashboard</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="features mt-4">
            <div class="row text-center">
                <div class="col-md-3">
                    <h6>‚è∞ Expiration</h6>
                    <small>Set automatic link expiry</small>
                </div>
                <div class="col-md-3">
                    <h6>üîí Password</h6>
                    <small>Protect sensitive links</small>
                </div>
                <div class="col-md-3">
                    <h6>üìà Analytics</h6>
                    <small>Detailed click tracking</small>
                </div>
                <div class="col-md-3">
                    <h6>üéØ Click Limits</h6>
                    <small>Control link usage</small>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function copyToClipboard() {
    const urlInput = document.getElementById('shortUrl');
    urlInput.select();
    document.execCommand('copy');
    
    const button = event.target;
    const originalText = button.textContent;
    button.textContent = 'Copied!';
    button.classList.remove('btn-outline-secondary');
    button.classList.add('btn-success');
    
    setTimeout(() => {
        button.textContent = originalText;
        button.classList.remove('btn-success');
        button.classList.add('btn-outline-secondary');
    }, 2000);
}
</script>
{% endblock %}